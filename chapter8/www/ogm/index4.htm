<!DOCTYPE HTML>
<HTML>
<head>
	<meta http-equiv="refresh" content="1;url=http://192.168.0.101/ogm/index4.htm">

	<title>Occupancy grid map</title>

	<!-- CSS -->
	<link rel="stylesheet" href="./styles/bootstrap.css">
	<link rel="stylesheet" href="./styles/bootstrap-responsive.css">
	<link rel="stylesheet" href="./styles/ev3webui.css">
	
	<!-- JAVASCRIPT -->
 	<script type="text/javascript" src="./js/jquery-2.0.3.min.js" ></script>
	<script type="text/javascript" src="./js/map.js" ></script>
	<script type="text/javascript" src="./js/distances.js" ></script>
	<script type="text/javascript">

	function fillMap(mapObj,data,color){
		var width = "5";
		var angle = 0;
		var range = 0;
		var x = 0;
		var y = 0;
		var xx = 0;
		var yy = 0;
		var center = 500;

		var canvas = document.getElementById(mapObj);


		for(i=0;i<distances.length;i++){
			if (canvas.getContext) {

/*
    double range = scan_in->ranges[i];
    //find the point in base_laser_link frame corresponding to the scan
    closest_angle = ((double)i*scan_in->angle_increment)+scan_in->angle_min;
    double x = range * cos (closest_angle);
    double y = range * sin (closest_angle);

*/
angle = distances[i][0];
range = distances[i][1];
x = range * Math.cos(angle);
y = range * Math.sin(angle);
console.log(angle + " " + range + " " + x + " " +y);
xx = 500 + (x*width)*0.2;
yy = 500 + (y*width)*0.2;
console.log(xx + " " + yy);
		
					var context = canvas.getContext('2d');

					context.fillStyle = "rgb(150,29,28)"; // Yellow		
					context.fillRect(xx,yy,width,width);
			}
		}
	}

	$(function() {
		fillMap("mapR",mapR,"rgb(255,155,0)");
	});
    </script>
</head>
<body>
	<canvas id="mapR" width="1000" height="1000"></canvas>
</body>
</html>
